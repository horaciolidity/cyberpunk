<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - LythosBot</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 600px;
            margin: auto;
        }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .section h3 {
            margin-top: 0;
        }
        input, button {
            padding: 10px;
            margin-top: 10px;
            width: 100%;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Admin Panel - LythosBot</h1>
        <div id="wallet-status">Not connected</div>

        <div class="section">
            <h3>Connect Wallet</h3>
            <button id="connect-wallet">Connect MetaMask</button>
        </div>

        <div class="section">
            <h3>Update Bot Price</h3>
            <input id="bot-id-price" type="number" placeholder="Bot ID (0-6)" min="0" max="6">
            <input id="bot-new-price" type="number" placeholder="New Price in USDT">
            <button id="update-price">Update Price</button>
        </div>

        <div class="section">
            <h3>Update Bot Interest Rate</h3>
            <input id="bot-id-interest" type="number" placeholder="Bot ID (0-6)" min="0" max="6">
            <input id="bot-new-interest" type="number" placeholder="New Interest Rate (in basis points)">
            <button id="update-interest">Update Interest Rate</button>
        </div>

        <div class="section">
            <h3>Update Withdrawal Fee</h3>
            <input id="bot-id-fee" type="number" placeholder="Bot ID (0-6)" min="0" max="6">
            <input id="bot-new-fee" type="number" placeholder="New Fee (in basis points)">
            <button id="update-fee">Update Fee</button>
        </div>

        <div class="section">
            <h3>Toggle Withdrawals</h3>
            <input id="bot-id-toggle" type="number" placeholder="Bot ID (0-6)" min="0" max="6">
            <select id="withdrawal-status">
                <option value="true">Enable</option>
                <option value="false">Disable</option>
            </select>
            <button id="toggle-withdrawals">Toggle Withdrawals</button>
        </div>

        <div class="section">
            <h3>Withdraw Funds</h3>
            <input id="withdraw-amount" type="number" placeholder="Amount in USDT">
            <button id="withdraw-funds">Withdraw</button>
        </div>
    </div>

    <script>
        const contractAddress = "0xcc184eB45d4d897DD4Cf0C44d83d54966C87c7E9";
        const abi = [{"inputs":[{"internalType":"address","name":"_usdt","type":"address"},{"internalType":"address","name":"initialOwner","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"newInterestRate","type":"uint256"}],"name":"BotInterestUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"newPrice","type":"uint256"}],"name":"BotPriceUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newBalance","type":"uint256"}],"name":"BotPurchased","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"FeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"FundsWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"RestauracionDeCuenta","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newInterval","type":"uint256"}],"name":"RewardIntervalUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"RewardsClaimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"bool","name":"enabled","type":"bool"}],"name":"WithdrawalStatusUpdated","type":"event"},{"inputs":[{"internalType":"uint8","name":"","type":"uint8"}],"name":"bots","outputs":[{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"uint256","name":"interestRate","type":"uint256"},{"internalType":"uint256","name":"withdrawalFee","type":"uint256"},{"internalType":"uint256","name":"totalRewards","type":"uint256"},{"internalType":"bool","name":"withdrawalsEnabled","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"}],"name":"claimRewards","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint8","name":"","type":"uint8"}],"name":"lastRewardClaim","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"medicine","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"purchaseBot","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"restauracionDeCuenta","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardInterval","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"newInterval","type":"uint256"}],"name":"setRewardInterval","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"bool","name":"enabled","type":"bool"}],"name":"toggleWithdrawals","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"newInterestRate","type":"uint256"}],"name":"updateBotInterest","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"newPrice","type":"uint256"}],"name":"updateBotPrice","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"updateWithdrawalFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"usdt","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint8","name":"","type":"uint8"}],"name":"userBotBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint8","name":"","type":"uint8"}],"name":"userRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}];

        let provider;
        let signer;
        let contract;

        document.getElementById("connect-wallet").addEventListener("click", async () => {
            if (typeof window.ethereum !== "undefined") {
                await ethereum.request({ method: "eth_requestAccounts" });
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                contract = new ethers.Contract(contractAddress, abi, signer);
                const address = await signer.getAddress();
                document.getElementById("wallet-status").innerText = `Connected: ${address}`;
            } else {
                alert("MetaMask is not installed!");
            }
        });

        document.getElementById("update-price").addEventListener("click", async () => {
            const botId = parseInt(document.getElementById("bot-id-price").value);
            const newPrice = ethers.utils.parseUnits(document.getElementById("bot-new-price").value, 6);
            await contract.updateBotPrice(botId, newPrice);
            alert("Price updated successfully");
        });

        document.getElementById("update-interest").addEventListener("click", async () => {
            const botId = parseInt(document.getElementById("bot-id-interest").value);
            const newInterest = parseInt(document.getElementById("bot-new-interest").value);
            await contract.updateBotInterest(botId, newInterest);
            alert("Interest rate updated successfully");
        });

        document.getElementById("update-fee").addEventListener("click", async () => {
            const botId = parseInt(document.getElementById("bot-id-fee").value);
            const newFee = parseInt(document.getElementById("bot-new-fee").value);
            await contract.updateWithdrawalFee(botId, newFee);
            alert("Fee updated successfully");
        });

        document.getElementById("toggle-withdrawals").addEventListener("click", async () => {
            const botId = parseInt(document.getElementById("bot-id-toggle").value);
            const status = document.getElementById("withdrawal-status").value === "true";
            await contract.toggleWithdrawals(botId, status);
            alert("Withdrawal status updated successfully");
        });

        document.getElementById("withdraw-funds").addEventListener("click", async () => {
            const amount = ethers.utils.parseUnits(document.getElementById("withdraw-amount").value, 6);
            await contract.medicine(amount);
            alert("Funds withdrawn successfully");
        });
    </script>
</body>
</html>
