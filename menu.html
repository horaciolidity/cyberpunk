<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lythos Bots</title>
  <link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@6.7.0/dist/ethers.umd.min.js"></script>


  <style>
    @import url(https://fonts.googleapis.com/css?family=Share+Tech+Mono);

    body,
    html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-y: scroll;
      font-family: 'Share Tech Mono', monospace;
      color: #db0e15;
      font-size: 14px; /* Reducida */
     
      background: url(https://image.ibb.co/h2hLAJ/bg.png) #000;
    }

.header {
    font-size: 14px;
    font-weight: bold;
    background: rgba(0, 255, 204, 0.2);
    border: 1px solid rgba(0, 255, 204, 0.5);
    padding: 15px;
    width: 200px;
    margin: auto;
    border-radius: 10px;
    box-shadow: 0px 0px 10px rgba(0, 255, 204, 0.4);
    white-space: nowrap;
    overflow: hidden;
    position: relative;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
}

.header span {
    display: inline-block;
    position: relative;
    color: #ffcc00;
    text-shadow: 0 0 5px #ffcc00, 0 0 10px #ffcc00, 0 0 15px #ff6600;
}

@keyframes slide-in {
    from {
        transform: translateX(100%);
    }
    to {
        transform: translateX(0);
    }
}


/* Efecto de luces LED */
.header::before,
.header::after {
    content: "";
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: red;
    box-shadow: 0 0 8px red;
    top: 50%;
    transform: translateY(-50%);
    animation: blink 1s infinite alternate;
}

.header::before {
    left: 5px;
}

.header::after {
    right: 5px;
    animation-delay: 0.5s;
}

@keyframes blink {
    0% { background: red; box-shadow: 0 0 8px red; }
    100% { background: yellow; box-shadow: 0 0 12px yellow; }
}
   
    .container {
      position: relative;
      margin: 0 auto;
      width: 90%;
      max-width: 1080px;
      text-align: center;
    }

    .bot-card {
      background-color: #222;
      margin-bottom: 20px; /* Reducido */
      padding: 10px; /* Reducido */
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      color: #40E0D0; /* Color turquesa */

    }

    .bot-card h3 {
      font-size: 1.2em;
      margin-bottom: 10px;
    }

    .bot-card p {
      margin: 5px 0;
    }

    .tradingview-widget {
      margin: 5px 0; /* Reducido */
      width: 100%;
      height: 200px; /* Reducido */
      border: 2px solid #22edfc;
      border-radius: 5px;
      overflow: hidden;
      position: relative;
    }

    .button {
      margin: 5px; /* Reducido */
      padding: 5px 10px; /* Reducido */
      background: #db0e15;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 0.9em; /* Reducido */
      border-radius: 5px;
    }

    .button:hover {
      background: #b20812;
    }

    .theme-button {
      margin-top: 10px; /* Reducido */
      padding: 5px 10px; /* Reducido */
      background: #22edfc;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 0.9em; /* Reducido */
      border-radius: 5px;
    }

    .theme-button:hover {
      background: #1cc0d3;
    }

     .guide {
  position: absolute;
  width: 40px; /* Reducir el ancho */
  height: 2px;
  right: 0; /* Mover al borde derecho */
  background-color: transparent;
  z-index: 10;
  animation: blink 1s infinite;
}

   .guide.red {
  background-color: red;
  animation: blinkRed 1s infinite, flashGreen 5s infinite;
}

@keyframes flashGreen {
  0%, 90% { box-shadow: none; }
  91%, 100% { box-shadow: 0 0 15px green; }
}
   .status {
  display: flex;
  align-items: center; /* Alineación vertical */
  justify-content: center; /* Alineación horizontal */
  margin: 10px 0;
}

/* Estilo para el estado del bot */
.bot-status {
  font-weight: bold;
  font-size: 14px;
  text-align: center; /* Asegura que el texto también esté centrado */
}

/* Estado inactivo */
.bot-inactive {
  color: red;
}

/* Estado activo */
.bot-active {
  color: green;
}

/* Luz de estado */
.status-light {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  display: inline-block;
  margin-left: 5px;
}

/* Luz roja (inactivo) */
.red {
  background-color: red;
}

/* Luz verde (activo) */
.green {
  background-color: green;
}

/* Linternas */
.lantern {
  position: absolute;
  top: 10px;
  width: 10px; /* Reducido a la mitad */
  height: 10px; /* Reducido a la mitad */
  border-radius: 50%;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.5); /* Ajustado para el nuevo tamaño */
}

.lantern.red {
  background-color: darkred;
  right: 50px;
}

.lantern.green {
  background-color: darkgreen;
  right: 20px;
}

/* Animaciones */
.active.red {
  animation: blink-red 1s infinite;
}

.active.green {
  animation: blink-green 1s infinite;
}

@keyframes blink-red {
  0%, 50% {
    background-color: red;
    box-shadow: 0 0 7.5px red; /* Ajustado para el tamaño reducido */
  }
  51%, 100% {
    background-color: darkred;
    box-shadow: none;
  }
}

@keyframes blink-green {
  0%, 50% {
    background-color: green;
    box-shadow: 0 0 7.5px green; /* Ajustado para el tamaño reducido */
  }
  51%, 100% {
    background-color: darkgreen;
    box-shadow: none;
  }
}
    /* New section for the header and referal stats */
    .referal-stats {
      margin-top: 20px;
      display: flex;
      justify-content: space-around;
      color: #22edfc;
    }

    .referal-box {
      background-color: #333;
      padding: 10px;
      border-radius: 5px;
      width: 25%;
    }

    .referal-box h4 {
      font-size: 1.1em;
      margin-bottom: 10px;
    }

    .referal-box p {
      font-size: 0.9em;
    }

    .referal-button {
      margin-top: 10px;
      padding: 5px 10px;
      background: #22edfc;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 0.9em;
      border-radius: 5px;
    }

    .referal-button:hover {
      background: #1cc0d3;
    }
.container {
      margin-top: 20px;
    }
    .info-box {
      background-color: #1e1e1e;
      padding: 20px;
      margin: 10px auto;
      border-radius: 10px;
      max-width: 500px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      color: #40E0D0; /* Color turquesa */

    }
    .info-box h3 {
      margin: 0 0 10px;
    }
    .info-box p {
      margin: 5px 0;
    }
    .bot-info span {
   color: yellow;
}
h3 {
  font-size: 20px;
  font-weight: bold;
  color: #FFD700; /* Amarillo dorado */
  text-shadow: 0 0 5px #FFD700, 0 0 10px #FFD700, 0 0 20px #FFAA00, 0 0 40px #FF8000;
  animation: glow 1.5s infinite alternate;
}

@keyframes glow {
  0% {
    text-shadow: 0 0 5px #FFD700, 0 0 10px #FFD700, 0 0 20px #FFAA00, 0 0 40px #FF8000;
  }
  100% {
    text-shadow: 0 0 10px #FFF700, 0 0 20px #FFD700, 0 0 30px #FFAA00, 0 0 50px #FF4500;
  }
}
     .tabs-container {
            max-width: 600px;
            margin: auto;
        }

        .tabs {
            display: flex;
            justify-content: space-around;
            border-bottom: 2px solid #444;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            position: relative;
            transition: 0.3s;
            color: #ccc;
        }

        .tab:hover, .tab.active {
            color: #00ffcc;
        }

        .tab::after {
            content: "";
            position: absolute;
            bottom: -2px;
            left: 50%;
            width: 0;
            height: 2px;
            background: #00ffcc;
            transition: width 0.3s ease, left 0.3s ease;
        }

        .tab.active::after {
            width: 100%;
            left: 0;
        }

        .tab-content {
            display: none;
            padding: 20px;
            border-radius: 10px;
            background: rgba(0, 255, 204, 0.1);
            border: 1px solid rgba(0, 255, 204, 0.3);
            box-shadow: 0px 0px 10px rgba(0, 255, 204, 0.4);
            margin-top: 10px;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
   .ufo-button {
            position: relative;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            color: #00eaff;
            background: linear-gradient(45deg, #002244, #003366);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 0 15px #00eaff, 0 0 30px rgba(0, 255, 255, 0.3);
            transition: all 0.3s ease-in-out;
            overflow: hidden;
        }

        .ufo-button::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: radial-gradient(circle, rgba(0, 238, 255, 0.6) 10%, transparent 60%);
            transform: translate(-50%, -50%) scale(0);
            transition: transform 0.5s ease-out;
        }

        .ufo-button:hover::before {
            transform: translate(-50%, -50%) scale(1);
        }

        .ufo-button:hover {
            background: linear-gradient(45deg, #003366, #004488);
            box-shadow: 0 0 20px #00eaff, 0 0 40px rgba(0, 255, 255, 0.5);
        }

        .ufo-button span {
            position: relative;
            z-index: 2;
        }
  </style>
</head>
<body class="dark-theme">
    <div class="container">

 <div class="header">7 Bots disponibles Lythos</div>
       <button class="ufo-button">
        <span>🔥 Gana Lythos - Próximo Lanzamiento 🚀</span>
    </button>

 <div class="tabs-container">
    <div class="tabs">
        <div class="tab active" onclick="openTab(0)">🤖 Retiros</div>
        <div class="tab" onclick="openTab(1)">🔐 Seguridad</div>
        <div class="tab" onclick="openTab(2)">🚀 Tecnología</div>
        <div class="tab" onclick="openTab(3)">🔄 USDT</div>
    </div>

    <div class="tab-content active">
        <h2>🤖 Retiros Habilitados Cada 24 Horas en Optimism</h2>
        <p>Nuestros bots operan sobre <strong>Optimism Layer 2</strong>, utilizando la arquitectura de <strong>Rollups Optimistas</strong> para procesar transacciones de forma eficiente y con costos reducidos. Gracias a la <strong>agregación de transacciones en lotes</strong>, los retiros pueden ejecutarse sin congestión, garantizando tiempos de confirmación mínimos.</p>
    </div>

    <div class="tab-content">
        <h2>🔐 Transacciones 100% Seguras y Verificadas</h2>
        <p>El contrato inteligente está desarrollado en <strong>Solidity 0.8.20</strong> y optimizado con <strong>gas-efficient patterns</strong>, reduciendo el consumo innecesario de gas en cada operación. Además, implementa medidas de seguridad como <strong>Reentrancy Guards</strong> y <strong>SafeMath</strong> para evitar vulnerabilidades comunes en los protocolos DeFi.</p>
    </div>

    <div class="tab-content">
        <h2>🚀 Tecnología de Última Generación en Optimism</h2>
        <p>Los bots utilizan un modelo de <strong>interés compuesto dinámico</strong>, calculado en base a la participación del usuario y gestionado a través de <strong>mapping structures en EVM</strong>, optimizando la lectura y escritura en la blockchain. El protocolo también incorpora la API de <strong>TradingView</strong> para obtener cotizaciones en tiempo real, asegurando precios actualizados al momento de realizar transacciones.</p>
    </div>

    <div class="tab-content">
        <h2>🔄 Integración con USDT en Optimism</h2>
        <p>El sistema funciona con <strong>USDT en la red Optimism</strong>, aprovechando el estándar <strong>ERC-20</strong> y el manejo de permisos mediante la función <code>approve()</code> y <code>transferFrom()</code>. Esto permite que los usuarios interactúen directamente con el contrato sin intervención de terceros, manteniendo la descentralización y seguridad de los fondos.</p>
    </div>
</div>
   
  <div class="container">
    <div class="info-box">
      <h3>Dirección Conectada:</h3>
      <p id="account">Conectando...</p>
    </div>
    <div class="info-box">
      <h3>Saldo en ETH:</h3>
      <p id="balanceEth">Cargando...</p>
    </div>
    <div class="info-box">
      <h3>Saldo en USDT:</h3>
      <p id="balanceUsdt">Cargando...</p>
    </div>
    </div>
 

    <!-- Bot 1 -->
<div class="bot-card" data-bot-id="0">
      <h3>Bot 1 - BTC/USDT</h3>
      <div class="status">
 <p><strong>Estado:</strong> <span id="botStatus0" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight0" class="status-light red"></span>
</div>

      <p>Profit: 3% diario | Congelamiento: 30 días | Fee de Retiro: 7%</p>
      <p>1. AI-Bot base : Min 30 USDT - Max 3000 USDT </p>

      <div class="bot-info" data-bot-id="0">
  <p><strong>Saldo:</strong> <span id="userBalance0">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards0">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee0">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim0">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice0">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance0">Cargando...</span> USDT</p>
</div>

     
      <div class="tradingview-widget">
         <div class="lantern red"></div>
  <div class="lantern green"></div>
<div id="red-guide-${botId}" class="guide red"></div>
        <iframe src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:BTCUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
      </div>
     <div class="button-group">
 <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="0" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="0">🎁 Reclamar Recompensas</button>
  <button class="button danger" onclick="withdraw(0)">Retirar</button>

  
  <button class="button info" onclick="showDetails(1)">📝 Detalles del Bot</button>
       
  <button class="button info" onclick="analyzePerformance(1)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(1)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(1)">📤 Exportar Reporte</button>
</div>

    </div>

    <!-- Bot 2 -->
<div class="bot-card" data-bot-id="1">
      <h3>Bot 2 - BTC/ETH</h3>
      <div class="status">
 <p><strong>Estado:</strong> <span id="botStatus1" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight1" class="status-light red"></span>
</div>

      <p>Profit: 3.5% diario | Congelamiento: 15 días | Fee de Retiro: 7%</p>
      <p>IA-Bot base + 1: Min 50 USDT - Max 5000 USDT</p>

<div class="bot-info" data-bot-id="1">
   <p><strong>Saldo:</strong> <span id="userBalance1">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards1">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee1">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim1">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice1">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance1">Cargando...</span> USDT</p>
</div>


      
      <div class="tradingview-widget">
        <div class="lantern red"></div>
  <div class="lantern green"></div>
<div id="red-guide-${botId}" class="guide red"></div>
        <iframe src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:ETHUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
        </div>

     <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="1" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="1">🎁 Reclamar Recompensas</button>
  <button class="button danger" onclick="withdraw(1)">Retirar</button>

  
  <button class="button info" onclick="showDetails(1)">📝 Detalles del Bot</button>
  <button class="button info" onclick="analyzePerformance(1)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(1)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(1)">📤 Exportar Reporte</button>
</div>
    </div>


    <!-- Bot 3 -->
<div class="bot-card" data-bot-id="2">
      <h3>Bot 3 - BCH/USDT</h3>
      <div class="status">
 <p><strong>Estado:</strong> <span id="botStatus2" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight2" class="status-light red"></span>
</div>

      <p>Profit: 4% diario | Congelamiento: 15 días | Fee de Retiro: 7%</p>
      <p>IA-Bot + 2: Min 100 USDT - Max 5000 USDT</p>

      <div class="bot-info" data-bot-id="2">
   <p><strong>Saldo:</strong> <span id="userBalance2">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards2">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee2">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim2">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice2">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance2">Cargando...</span> USDT</p>
</div>


      <div class="tradingview-widget">
         <div class="lantern red"></div>
  <div class="lantern green"></div>
<div id="red-guide-${botId}" class="guide red"></div>
        <iframe loading="lazy" src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:BCHUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
        </div>

   <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="2" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="2">🎁 Reclamar Recompensas</button>
  <button class="button danger" onclick="withdraw(2)">Retirar</button>

  
  <button class="button info" onclick="showDetails(2)">📝 Detalles del Bot</button>
  <button class="button info" onclick="analyzePerformance(2)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(2)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(2)">📤 Exportar Reporte</button>
</div>

    </div>

          <!-- Bot 3 -->
<div class="bot-card" data-bot-id="3">
      <h3>Bot 4 - WLD/USDT</h3>
      <div class="status">
 <p><strong>Estado:</strong> <span id="botStatus3" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight3" class="status-light red"></span>
</div>

      <p>Profit: 4.3% diario | Congelamiento: 15 días | Fee de Retiro: 7%</p>
      <p>Mínimo para alquilar: Min 200 USDT - Max 9000 USDT</p>
      <div class="bot-info" data-bot-id="3">
  <p><strong>Saldo:</strong> <span id="userBalance3">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards3">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee3">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim3">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice3">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance3">Cargando...</span> USDT</p>
</div>

      <div class="tradingview-widget">
       <div class="lantern red"></div>
  <div class="lantern green"></div>
<div id="red-guide-${botId}" class="guide red"></div>
        <iframe loading="lazy" src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:WLDUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
        </div>

   <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="3" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="3">🎁 Reclamar Recompensas</button>
  <button class="button danger" onclick="withdraw(3)">Retirar</button>

  
  <button class="button info" onclick="showDetails(3)">📝 Detalles del Bot</button>
  <button class="button info" onclick="analyzePerformance(3)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(3)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(3)">📤 Exportar Reporte</button>
</div>

    </div>

          <!-- Bot 3 -->
<div class="bot-card" data-bot-id="4">
      <h3>Bot 5 - DOGE/USDT</h3>
      <div class="status">
 <p><strong>Estado:</strong> <span id="botStatus4" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight4" class="status-light red"></span>
</div>

      <p>Profit: 4.7% diario | Congelamiento: 15 días | Fee de Retiro : 7%</p>
      <p>Lythos Bot : Min 400 USDT Max 16000 USDT</p>

   <div class="bot-info" data-bot-id="4">
  <p><strong>Saldo:</strong> <span id="userBalance4">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards4">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee4">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim4">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice4">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance4">Cargando...</span> USDT</p>
</div>

      <div class="tradingview-widget">
        <div class="lantern red"></div>
  <div class="lantern green"></div>
    <div id="red-guide-${botId}" class="guide red"></div>
        <iframe loading="lazy" src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:DOGEUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
        </div>

   <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="4" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="4">🎁 Reclamar Recompensas</button>
  <button class="button danger" onclick="withdraw(4)">Retirar</button>

  <button class="button info" onclick="showDetails(4)">📝 Detalles del Bot</button>
  <button class="button info" onclick="analyzePerformance(4)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(4)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(4)">📤 Exportar Reporte</button>
</div>
    </div>


          <!-- Bot 3 -->
<div class="bot-card" data-bot-id="5">
      <h3>Bot 6 - ENA/USDT</h3>
      <div class="status">
 <p><strong>Estado:</strong> <span id="botStatus5" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight5" class="status-light red"></span>
</div>

      <p>Profit: 5.4% diario | Congelamiento: 15 días | Fee de Retiro: 7%</p>
      <p>Lythos Bot + 1: Min 800 USDT Max 22000 USDT</p>
     <div class="bot-info" data-bot-id="5">
  <p><strong>Saldo:</strong> <span id="userBalance5">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards5">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee5">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim5">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice5">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance5">Cargando...</span> USDT</p>
</div>

      <div class="tradingview-widget">
        <div class="lantern red"></div>
  <div class="lantern green"></div>
<div id="red-guide-${botId}" class="guide red"></div>
        <iframe loading="lazy"  src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:ENAUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
        </div>

   <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="5" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="5">🎁 Reclamar Recompensas</button>
     <button class="button danger" onclick="withdraw(5)">Retirar</button>

  <button class="button info" onclick="showDetails(5)">📝 Detalles del Bot</button>
  <button class="button info" onclick="analyzePerformance(1)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(1)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(1)">📤 Exportar Reporte</button>
</div>
    </div>

          <!-- Bot 3 -->
<div class="bot-card" data-bot-id="6">
      <h3>Bot 7 - COW/USDT</h3>
      <div class="status">
<p><strong>Estado:</strong> <span id="botStatus6" class="bot-status bot-inactive">Bot inactivo</span></p>
  <span id="botStatusLight6" class="status-light red"></span>
</div>

      <p>Profit: 6.7% diario | Congelamiento: 15 días | Fee de Retiro: 7%</p>
      <p>Lythos Bot + 3: Min 1600 USDT Max 32000 USDT</p>
      <div class="bot-info" data-bot-id="6">
  <p><strong>Saldo:</strong> <span id="userBalance6">Cargando...</span> USDT</p>
  <p><strong>Recompensas Pendientes:</strong> <span id="pendingRewards6">Cargando...</span> USDT</p>
  <p><strong>Fee de Retiro:</strong> <span id="withdrawalFee6">Cargando...</span>%</p>
  <p><strong>Tiempo para Reclamar:</strong> <span id="timeUntilClaim6">Cargando...</span></p>
  <p><strong>Aviso:</strong> <span id="claimNotice6">Cargando...</span></p>
  <p><strong>Saldo Total:</strong> <span id="userTotalBalance6">Cargando...</span> USDT</p>
</div>

      <div class="tradingview-widget">
         <div class="lantern red"></div>
  <div class="lantern green"></div>
<div id="red-guide-${botId}" class="guide red"></div>
        <iframe loading="lazy" src="https://s.tradingview.com/widgetembed/?symbol=BINANCE:COWUSDT&interval=5&theme=dark&style=1&locale=es&toolbar_bg=%23f1f3f6&hide_top_toolbar=true&hide_legend=true" 
                width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
        </div>

   <div class="button-group">
<input type="number" class="usdtAmount" data-bot-id="6" placeholder="Cantidad en USDT">
  <button class="button primary">Comprar Bot</button>
<button class="button success claim-btn" data-bot-id="6">🎁 Reclamar Recompensas</button>
     <button class="button danger" onclick="withdraw(6)">Retirar</button>

  <button class="button info" onclick="showDetails(6)">📝 Detalles del Bot</button>
  <button class="button info" onclick="analyzePerformance(1)">📈 Analizar Rendimiento</button>
  <button class="button info" onclick="viewHistory(1)">📜 Historial de Transacciones</button>
  <button class="button info" onclick="compareBots()">📊 Comparar Bots</button>
  <button class="button support" onclick="getTips()">💡 Consejos de Trading</button>
  <button class="button secondary" onclick="exportReport(1)">📤 Exportar Reporte</button>
</div>
    </div>

    <!-- Botones de cambio de tema y soporte -->
    <button class="theme-button" onclick="changeTheme('dark')">Tema Oscuro</button>
    <button class="theme-button" onclick="changeTheme('light')">Tema Claro</button>
    <button class="button">Llamar a Soporte</button>
    <button class="button">Reclamar Recompensa</button>
  </div>
 
  <!-- Agrega más bots según sea necesario -->
</select>
     

  <script>
let web3;
let usdtContract;
let lythosBotContract;
let userAddress;
let web3Ready = false;

const usdtContractAddress = "0x94b008aA00579c1307B0EF2c499aD98a8ce58e58"; 
const lythosBotContractAddress = "0x5971f935B3d68e48762Bf4A3820333104870513d"; 
const usdtABI = [
  {"inputs":[{"internalType":"address","name":"_l2Bridge","type":"address"},{"internalType":"address","name":"_l1Token","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},
  {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},
  {"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},
  {"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},
  {"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},
  {
    "inputs": [
      { "internalType": "address", "name": "owner", "type": "address" },
      { "internalType": "address", "name": "spender", "type": "address" }
    ],
    "name": "allowance",
    "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }],
    "stateMutability": "view",
    "type": "function"
  }
];

const lythosBotABI = [{"inputs":[{"internalType":"address","name":"_usdt","type":"address"},{"internalType":"address","name":"initialOwner","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"newInterestRate","type":"uint256"}],"name":"BotInterestUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"newPrice","type":"uint256"}],"name":"BotPriceUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newBalance","type":"uint256"}],"name":"BotPurchased","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"FeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"FundsWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"RestauracionDeCuenta","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newInterval","type":"uint256"}],"name":"RewardIntervalUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"RewardsClaimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"TransferFailed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint8","name":"botId","type":"uint8"},{"indexed":false,"internalType":"bool","name":"enabled","type":"bool"}],"name":"WithdrawalStatusUpdated","type":"event"},{"inputs":[{"internalType":"uint8","name":"","type":"uint8"}],"name":"bots","outputs":[{"internalType":"uint256","name":"price","type":"uint256"},{"internalType":"uint256","name":"interestRate","type":"uint256"},{"internalType":"uint256","name":"withdrawalFee","type":"uint256"},{"internalType":"uint256","name":"totalRewards","type":"uint256"},{"internalType":"bool","name":"withdrawalsEnabled","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"}],"name":"claimRewards","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint8","name":"","type":"uint8"}],"name":"lastRewardClaim","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"medicine","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"purchaseBot","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"restauracionDeCuenta","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardInterval","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"newInterval","type":"uint256"}],"name":"setRewardInterval","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"bool","name":"enabled","type":"bool"}],"name":"toggleWithdrawals","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"newInterestRate","type":"uint256"}],"name":"updateBotInterest","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"newPrice","type":"uint256"}],"name":"updateBotPrice","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint8","name":"botId","type":"uint8"},{"internalType":"uint256","name":"newFee","type":"uint256"}],"name":"updateWithdrawalFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"usdt","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint8","name":"","type":"uint8"}],"name":"userBotBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint8","name":"","type":"uint8"}],"name":"userRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]; 


async function initializeWeb3() {
  if (typeof window.ethereum !== "undefined") {
    try {
      // Inicializar Web3
      web3 = new Web3(window.ethereum);

      // Cambiar a la red Optimism
      await window.ethereum.request({
        method: "wallet_switchEthereumChain",
        params: [{ chainId: "0xa" }], // Chain ID para Optimism
      });

      // Solicitar cuentas a MetaMask
      const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
      const account = accounts[0];
      if (!account) {
        throw new Error("No se pudo obtener la cuenta de MetaMask.");
      }

      // Guardar la dirección del usuario globalmente
      userAddress = account;

      // Mostrar la dirección conectada
      document.getElementById("account").textContent = userAddress;

      // Obtener y mostrar el saldo en ETH
      const ethBalance = await web3.eth.getBalance(userAddress);
      document.getElementById("balanceEth").textContent = `${web3.utils.fromWei(ethBalance, "ether")} ETH`;

      // Inicializar el contrato de USDT
      usdtContract = new web3.eth.Contract(usdtABI, usdtContractAddress);

      // Obtener y mostrar el saldo en USDT
      const usdtBalance = await usdtContract.methods.balanceOf(userAddress).call();
      const usdtBalanceFormatted = (Number(usdtBalance) / 1e6).toFixed(2); // USDT tiene 6 decimales
      document.getElementById("balanceUsdt").textContent = `${usdtBalanceFormatted} USDT`;

      // Inicializar el contrato principal (LythosBot)
      lythosBotContract = new web3.eth.Contract(lythosBotABI, lythosBotContractAddress);
      web3Ready = true;

      // Actualizar información de los bots
      await updateAllBots();

      // Confirmar conexión en la consola
      console.log("Conexión establecida correctamente:");
      console.log("Cuenta conectada:", userAddress);
      console.log("Saldo en ETH:", web3.utils.fromWei(ethBalance, "ether"), "ETH");
      console.log("Saldo en USDT:", usdtBalanceFormatted, "USDT");

  } catch (error) {
    console.error("Error al conectar a MetaMask o cambiar de red:", error);
    alert("Error al conectar a MetaMask o cambiar de red. Revisa la consola para más detalles.");
  }
} else {
  alert("MetaMask no está instalado. Por favor, instálalo para continuar.");
}
}

window.addEventListener("load", initializeWeb3);

    
async function purchaseBot(event) {
  try {
    // Obtener la tarjeta del bot correspondiente al botón presionado
    const botCard = event.target.closest(".bot-card");
    if (!botCard) {
      alert("Error: No se pudo determinar el bot seleccionado.");
      return;
    }

    // Extraer ID del bot y cantidad ingresada
    const botId = parseInt(botCard.querySelector(".usdtAmount").getAttribute("data-bot-id"));
    const amountInUsdt = parseFloat(botCard.querySelector(".usdtAmount").value);

    // Validaciones
    if (isNaN(botId) || botId < 0 || botId > 6) {
      alert("Error: El ID del bot no es válido.");
      return;
    }

    if (isNaN(amountInUsdt) || amountInUsdt <= 0) {
      alert("Por favor, ingresa una cantidad válida en USDT.");
      return;
    }

    // Convertir el monto a micro-unidades (1 USDT = 10^6 micro-unidades)
    const amountInMicroUnits = BigInt(Math.floor(amountInUsdt * 10 ** 6));

    console.log(`Intentando comprar Bot ${botId} con ${amountInMicroUnits} micro-unidades.`);

    // Verificar saldo en USDT antes de continuar
    const userBalance = BigInt(await usdtContract.methods.balanceOf(userAddress).call());
    if (amountInMicroUnits > userBalance) {
      alert("Saldo insuficiente en USDT para completar la compra.");
      return;
    }

    // Confirmar compra con el usuario
    const confirmation = confirm(`Vas a comprar el Bot ${botId} con ${(Number(amountInMicroUnits) / 1e6).toFixed(2)} USDT. ¿Deseas continuar?`);
    if (!confirmation) {
      alert("Compra cancelada.");
      return;
    }

    // Aprobar la transferencia de USDT
    console.log("Solicitando aprobación de transferencia...");
    await usdtContract.methods.approve(lythosBotContractAddress, amountInMicroUnits).send({ from: userAddress });
    console.log("Aprobación completada.");

    // Realizar la compra del bot
    console.log("Intentando realizar la compra...");
    const tx = await lythosBotContract.methods.purchaseBot(botId, amountInMicroUnits).send({ from: userAddress });
    console.log("Compra exitosa:", tx);
    alert("¡Compra realizada con éxito!");

    // Actualizar la información del bot después de la compra
    await updateBotInfo(botId);
  } catch (error) {
    console.error("Error al comprar el bot:", error);

    // Identificar y manejar errores específicos
    if (error.code === 4001) {
      alert("Transacción rechazada por el usuario.");
    } else if (error.message.includes("insufficient funds")) {
      alert("Fondos insuficientes para pagar la comisión de la red.");
    } else if (error.message.includes("revert")) {
      alert("El contrato rechazó la transacción. Verifica las condiciones para comprar este bot.");
    } else {
      alert("Error durante la compra. Revisa la consola para más detalles.");
    }
  }
}

async function updateBotInfo(botId) {
  try {
    if (!web3Ready) {
      console.warn("Web3 no está listo. Esperando...");
      return;
    }

    // Obtener datos del contrato relacionados con el bot y el usuario
    const userBalance = BigInt(await lythosBotContract.methods.userBotBalance(userAddress, botId).call());
    const pendingRewards = BigInt(await lythosBotContract.methods.userRewards(userAddress, botId).call());
    const botDetails = await lythosBotContract.methods.bots(botId).call();
    const lastRewardClaim = BigInt(await lythosBotContract.methods.lastRewardClaim(userAddress, botId).call());
    const rewardInterval = BigInt(await lythosBotContract.methods.rewardInterval().call());
    const currentTime = BigInt(Math.floor(Date.now() / 1000));

    // Seleccionar la tarjeta del bot específica en el DOM
    const botInfo = document.querySelector(`.bot-info[data-bot-id="${botId}"]`);
    if (!botInfo) {
      console.error(`No se encontró la tarjeta del bot con ID ${botId}`);
      return;
    }

    const botStatus = botInfo.querySelector(`#botStatus${botId}`);
    const botStatusLight = botInfo.querySelector(`#botStatusLight${botId}`);

    if (!botStatus || !botStatusLight) {
      console.warn(`Elementos botStatus${botId} o botStatusLight${botId} no encontrados.`);
      return;
    }

    // Verificar si el saldo es mayor a 0 para marcar el bot como activo
    if (userBalance > 0n) {
      botStatus.textContent = "Bot activo";
      botStatus.classList.remove("bot-inactive");
      botStatus.classList.add("bot-active");

      botStatusLight.classList.remove("red");
      botStatusLight.classList.add("green");
    } else {
      botStatus.textContent = "Bot inactivo";
      botStatus.classList.remove("bot-active");
      botStatus.classList.add("bot-inactive");

      botStatusLight.classList.remove("green");
      botStatusLight.classList.add("red");
    }

    // Calcular la tarifa de retiro y tiempo hasta el próximo reclamo
    const withdrawalFee = (userBalance * BigInt(botDetails.withdrawalFee)) / BigInt(10000);
    const timeUntilNextClaim = lastRewardClaim + rewardInterval - currentTime;

    // Actualizar los datos en la interfaz de usuario
    botInfo.querySelector(`#userBalance${botId}`).textContent = (Number(userBalance) / 1e6).toFixed(2);
    botInfo.querySelector(`#pendingRewards${botId}`).textContent = (Number(pendingRewards) / 1e6).toFixed(2);
    botInfo.querySelector(`#withdrawalFee${botId}`).textContent = `${(Number(withdrawalFee) / 1e6).toFixed(2)} USDT`;
    botInfo.querySelector(`#timeUntilClaim${botId}`).textContent =
      Number(timeUntilNextClaim) > 0 ? `${Math.ceil(Number(timeUntilNextClaim) / 3600)} horas` : "Disponible";
    botInfo.querySelector(`#claimNotice${botId}`).textContent =
      pendingRewards > 0n && timeUntilNextClaim <= 0n ? "¡Recompensa disponible!" : "No disponible";
    botInfo.querySelector(`#userTotalBalance${botId}`).textContent = 
      ((Number(userBalance) + Number(pendingRewards)) / 1e6).toFixed(2);

    console.log(`Bot ${botId}: Información actualizada correctamente.`);
  } catch (error) {
    console.error(`Error al actualizar el bot ${botId}:`, error);
    alert(`Hubo un problema al actualizar la información del Bot ${botId}. Revisa la consola para más detalles.`);
  }
}

function simulateGuides() {
  const widgets = document.querySelectorAll('.tradingview-widget');
  widgets.forEach((widget, index) => {
    const containerHeight = widget.offsetHeight;
    const redGuide = document.getElementById(`red-guide-${index + 1}`); // Corregido con comillas invertidas

    setInterval(() => {
      moveGuide(redGuide, containerHeight, -3, 3);
    }, Math.random() * 3000 + 2000);
  });
}

  document.querySelectorAll('.tradingview-widget').forEach((widget, index) => {
    const redLantern = widget.querySelector('.lantern.red');
    const greenLantern = widget.querySelector('.lantern.green');

    setInterval(() => {
      const isActive = Math.random() > 0.5;
      if (isActive) {
        redLantern.classList.add('active');
        greenLantern.classList.remove('active');
      } else {
        redLantern.classList.remove('active');
        greenLantern.classList.add('active');
      }
    }, 2000);
  });

async function updateAllBots() {
  try {
    if (!web3Ready) {
      console.warn("Web3 no está listo. Esperando...");
      return; // Salir si Web3 no está listo
    }

    // Array para almacenar las promesas de cada bot
    const promises = [];

    // Iterar sobre todos los bots (IDs del 0 al 6)
    for (let botId = 0; botId <= 6; botId++) {
      promises.push((async () => {
        // Obtener datos del contrato relacionados con el bot y el usuario
        const userBalance = BigInt(await lythosBotContract.methods.userBotBalance(userAddress, botId).call());
        const pendingRewards = BigInt(await lythosBotContract.methods.userRewards(userAddress, botId).call());
        const botDetails = await lythosBotContract.methods.bots(botId).call();
        const lastRewardClaim = BigInt(await lythosBotContract.methods.lastRewardClaim(userAddress, botId).call());
        const rewardInterval = BigInt(await lythosBotContract.methods.rewardInterval().call());
        const currentTime = BigInt(Math.floor(Date.now() / 1000));

        // Calcular la tarifa de retiro y tiempo hasta el próximo reclamo
        const withdrawalFee = (userBalance * BigInt(botDetails.withdrawalFee)) / BigInt(10000);
        const timeUntilNextClaim = lastRewardClaim + rewardInterval - currentTime;

        // Seleccionar la tarjeta del bot específica en el DOM
        const botInfo = document.querySelector(`.bot-info[data-bot-id="${botId}"]`);
        if (!botInfo) {
          console.error(`No se encontró la tarjeta del bot con ID ${botId}`);
          return; // Pasar al siguiente bot si no se encuentra la tarjeta
        }

        // Actualizar los datos en la interfaz de usuario
        botInfo.querySelector(`#userBalance${botId}`).textContent = (Number(userBalance) / 1e6).toFixed(2);
        botInfo.querySelector(`#pendingRewards${botId}`).textContent = (Number(pendingRewards) / 1e6).toFixed(2);
        botInfo.querySelector(`#withdrawalFee${botId}`).textContent = `${(Number(withdrawalFee) / 1e6).toFixed(2)} USDT`;
        botInfo.querySelector(`#timeUntilClaim${botId}`).textContent =
          Number(timeUntilNextClaim) > 0 ? `${Math.ceil(Number(timeUntilNextClaim) / 3600)} horas` : "Disponible";
        botInfo.querySelector(`#claimNotice${botId}`).textContent =
          pendingRewards > 0n && timeUntilNextClaim <= 0n ? "¡Recompensa disponible!" : "No disponible";
        botInfo.querySelector(`#userTotalBalance${botId}`).textContent = 
          ((Number(userBalance) + Number(pendingRewards)) / 1e6).toFixed(2);

        console.log(`Bot ${botId}: Datos actualizados correctamente.`);
      })());
    }

    // Esperar a que todas las promesas de los bots se resuelvan
    await Promise.all(promises);

    // Después de que todos los bots hayan sido actualizados, verificar si están activos
    for (let botId = 0; botId <= 6; botId++) {
      const botInfo = document.querySelector(`.bot-info[data-bot-id="${botId}"]`);
      if (!botInfo) continue; // Pasar si no se encuentra la tarjeta

      const botStatus = botInfo.querySelector(`#botStatus${botId}`);
      const botStatusLight = botInfo.querySelector(`#botStatusLight${botId}`);

      if (!botStatus || !botStatusLight) continue;

      // Verificar si el saldo es mayor a 0 para marcar el bot como activo
      const userBalance = BigInt(await lythosBotContract.methods.userBotBalance(userAddress, botId).call());
      if (userBalance > 0n) {
        botStatus.textContent = "Bot activo";
        botStatus.classList.remove("bot-inactive");
        botStatus.classList.add("bot-active");

        botStatusLight.classList.remove("red");
        botStatusLight.classList.add("green");
      } else {
        botStatus.textContent = "Bot inactivo";
        botStatus.classList.remove("bot-active");
        botStatus.classList.add("bot-inactive");

        botStatusLight.classList.remove("green");
        botStatusLight.classList.add("red");
      }
    }

  } catch (error) {
    console.error("Error al actualizar los datos de los bots:", error);
    alert("Hubo un error al obtener los datos de los bots. Revisa la consola para más detalles.");
  }
}

async function claimRewards(botId) {
  try {
    if (!web3Ready || !lythosBotContract) {
      alert("Conecta tu wallet primero.");
      return;
    }

    // 1. Verificar intervalo de recompensa
    const lastClaim = await lythosBotContract.methods.lastRewardClaim(userAddress, botId).call();
    const rewardInterval = await lythosBotContract.methods.rewardInterval().call();
    const currentTime = Math.floor(Date.now() / 1000);
    
    if (currentTime < Number(lastClaim) + Number(rewardInterval)) {
      const hoursLeft = Math.ceil((Number(lastClaim) + Number(rewardInterval) - currentTime) / 3600);
      alert(`Debes esperar ${hoursLeft} horas antes de reclamar nuevamente`);
      return;
    }

    // 2. Verificar si hay recompensas
    const pendingRewards = await lythosBotContract.methods.userRewards(userAddress, botId).call();
    if (Number(pendingRewards) === 0) {
      alert("No hay recompensas disponibles para este bot");
      return;
    }

    // 3. Verificar estado de retiros
    const botInfo = await lythosBotContract.methods.bots(botId).call();
    if (!botInfo.withdrawalsEnabled) {
      alert("Los retiros están deshabilitados para este bot");
      return;
    }

    // 4. Mostrar confirmación con detalles
    const rewardAmount = (Number(pendingRewards) / 1e6).toFixed(2);
    const feePercentage = Number(botInfo.withdrawalFee) / 100;
    const feeAmount = (rewardAmount * feePercentage).toFixed(2);
    const netAmount = (rewardAmount - feeAmount).toFixed(2);
    
    const confirmacion = confirm(
      `Reclamar ${rewardAmount} USDT?\n` +
      `Tarifa de retiro (${feePercentage}%): ${feeAmount} USDT\n` +
      `Recibirás: ${netAmount} USDT`
    );
    
    if (!confirmacion) return;

    // 5. Ejecutar transacción
    const tx = await lythosBotContract.methods.claimRewards(botId)
      .send({ from: userAddress });
    
    console.log("Transacción exitosa:", tx);
    alert(`¡Éxito! ${netAmount} USDT han sido transferidos a tu wallet`);

    // 6. Actualizar UI
    await updateBotInfo(botId);
    await updateUSDTBalance();

  } catch (error) {
    console.error("Error al reclamar:", error);
    
    if (error.code === 4001) {
      alert("Transacción cancelada por el usuario");
    } else if (error.message.includes("revert")) {
      const reason = error.message.match(/reverted with reason string '(.*)'/)?.[1] || "Error en el contrato";
      alert(`Error: ${reason}`);
    } else {
      alert("Error al procesar la transacción. Verifica la consola para más detalles");
    }
  }
}

// Función adicional para actualizar saldo USDT
async function updateUSDTBalance() {
  const usdtBalance = await usdtContract.methods.balanceOf(userAddress).call();
  const formattedBalance = (Number(usdtBalance) / 1e6).toFixed(2);
  document.getElementById("balanceUsdt").textContent = `${formattedBalance} USDT`;
}

    // Manejador para todos los botones de reclamar
document.querySelectorAll('.claim-btn').forEach(button => {
  button.addEventListener('click', async (e) => {
    const botId = parseInt(e.target.closest('.bot-card').dataset.botId);
    if (!isNaN(botId)) await claimRewards(botId);
  });
});

document.querySelectorAll(".button.primary").forEach(button => {
    button.addEventListener("click", async (event) => {
        try {
            const botCard = event.target.closest(".bot-card");
            if (!botCard) {
                alert("Error: No se pudo determinar el bot seleccionado.");
                return;
            }

            // Obtener el `botId` y la cantidad en USDT
            const botId = parseInt(botCard.querySelector(".usdtAmount").getAttribute("data-bot-id"));
            const amountInUsdt = parseFloat(botCard.querySelector(".usdtAmount").value);

            if (isNaN(botId)) {
                alert("Error: El ID del bot no es válido.");
                return;
            }

            if (isNaN(amountInUsdt) || amountInUsdt <= 0) {
                alert("Por favor, ingresa una cantidad válida en USDT.");
                return;
            }

            const amountInMicroUnits = amountInUsdt * 10 ** 6;
            console.log(`Intentando comprar Bot ${botId} con ${amountInMicroUnits} micro-unidades.`);

            // Aprobar la transferencia de USDT
            console.log("Solicitando aprobación de transferencia...");
            await usdtContract.methods.approve(contractAddress, amountInMicroUnits).send({ from: userAddress });
            console.log("Aprobación completada.");

            // Realizar la compra del bot
            console.log("Intentando realizar la compra...");
            const tx = await contract.methods.purchaseBot(botId, amountInMicroUnits).send({ from: userAddress });
            alert("¡Compra exitosa!");
            console.log("Detalles de la transacción:", tx);
        } catch (error) {
            console.error("Error al comprar el bot:", error);
            alert("Error durante la compra. Por favor, verifica tu saldo y vuelve a intentar.");
        }
    });
});

async function showUserDetails(botId) {
  try {
    const accounts = await web3.eth.getAccounts();
    const userAddress = accounts[0];

    if (!userAddress) {
      alert("No se pudo obtener la cuenta conectada. Asegúrate de estar conectado a MetaMask.");
      return;
    }

    // Obtener datos del usuario y bot desde el contrato
    const userBalance = await lythosBotContract.methods.getUserBotBalance(userAddress, botId).call();
    const pendingRewards = await lythosBotContract.methods.getPendingReward(userAddress, botId).call();
  const botDetails = await lythosBotContract.methods.bots(botId).call();

    // Calcular el porcentaje de ganancia
    const balance = parseFloat(userBalance) / 1e6;
    const rewards = parseFloat(pendingRewards) / 1e6;
    const profitPercentage = rewards > 0 ? ((rewards / balance) * 100).toFixed(2) : 0;

    // Mostrar los detalles en un modal o alerta
    alert(`
      Detalles del Bot ${botId}:
      - Saldo: ${balance.toFixed(2)} USDT
      - Recompensas Pendientes: ${rewards.toFixed(2)} USDT
      - Porcentaje de Ganancia: ${profitPercentage}%
      - Interés Diario: ${(botDetails.interestRate / 100).toFixed(2)}%
      - Retiros Habilitados: ${botDetails.withdrawalsEnabled ? "Sí" : "No"}
    `);
  } catch (error) {
    console.error("Error al obtener detalles del bot:", error);
    alert("No se pudieron obtener los detalles del bot. Intenta nuevamente.");
  }
}




async function withdraw(botId) {
  try {
    // Solicitar al usuario la cantidad de USDT para retirar
    const amount = prompt("Ingresa la cantidad de USDT para retirar:");
    if (!amount || isNaN(amount) || Number(amount) <= 0) {
      alert("Por favor, ingresa una cantidad válida para retirar.");
      return;
    }

    // Convertir el monto a micro-unidades (BigInt para evitar errores de precisión)
    const amountInMicroUnits = BigInt(Math.floor(Number(amount) * 10 ** 6));

    // Obtener la dirección del usuario conectado
    const accounts = await web3.eth.getAccounts();
    const userAddress = accounts[0];
    if (!userAddress) {
      alert("No se pudo obtener la cuenta conectada. Asegúrate de estar conectado a MetaMask.");
      return;
    }

    // Verificar el saldo del usuario en el bot
    const userBalance = BigInt(await contract.methods.getUserBotBalance(userAddress, botId).call());
    if (amountInMicroUnits > userBalance) {
      alert("Saldo insuficiente para retirar la cantidad solicitada.");
      return;
    }

    // Confirmar retiro con el usuario
    const confirmation = confirm(`Vas a retirar ${(Number(amountInMicroUnits) / 1e6).toFixed(2)} USDT del Bot ${botId}. ¿Deseas continuar?`);
    if (!confirmation) {
      alert("Operación cancelada.");
      return;
    }

    // Realizar el retiro
    alert("Realizando el retiro...");
    const tx = await contract.methods.withdrawBotBalance(botId, amountInMicroUnits).send({ from: userAddress });

    // Notificar éxito al usuario
    alert("¡Retiro exitoso!");
    console.log("Detalles de la transacción:", tx);

    // Actualizar la información del bot
    await updateBotInfo(botId, userAddress);
  } catch (error) {
    console.error("Error al retirar fondos:", error);

    // Identificar posibles errores
    if (error.code === 4001) {
      alert("Operación cancelada por el usuario.");
    } else if (error.message.includes("revert")) {
      alert("El contrato rechazó la transacción. Verifica las condiciones para retirar.");
    } else {
      alert("Ocurrió un error inesperado. Consulta la consola para más detalles.");
    }
  }
}

async function analyzePerformance(botId) {
  try {
    // Asegurarte de que se obtiene la dirección del usuario
    const accounts = await web3.eth.getAccounts();
    const userAddress = accounts[0];

    if (!userAddress) {
      alert("No se pudo obtener la cuenta conectada. Asegúrate de estar conectado a MetaMask.");
      return;
    }

    // Obtener detalles del bot desde el contrato
const botBalance = BigInt(await lythosBotContract.methods.userBotBalance(userAddress, botId).call());   
    const pendingRewards = BigInt(await lythosBotContract.methods.getPendingReward(userAddress).call());
    const lastClaim = BigInt(await lythosBotContract.methods.lastRewardClaim(userAddress).call());
    const bot = await lythosBotContract.methods.bots(botId).call();

    // Convertir valores BigInt a Number para su manejo
    const balanceFormatted = Number(botBalance) / 1e6;
    const rewardsFormatted = Number(pendingRewards) / 1e6;
    const lastClaimDate = new Date(Number(lastClaim) * 1000).toLocaleString();

    // Mostrar los datos en la interfaz
    alert(`
      Rendimiento del Bot ${botId}:
      - Saldo: ${balanceFormatted.toFixed(2)} USDT
      - Recompensas Pendientes: ${rewardsFormatted.toFixed(2)} USDT
      - Última Fecha de Reclamo: ${lastClaimDate}
      - Interés: ${(Number(bot.interestRate) / 100).toFixed(2)}%
      - Retiros Habilitados: ${bot.withdrawalsEnabled ? "Sí" : "No"}
    `);
  } catch (error) {
    console.error("Error al analizar el rendimiento:", error);

    // Identificar posibles errores
    if (error.message.includes("Cannot mix BigInt")) {
      alert("Hubo un problema al procesar valores del contrato. Asegúrate de estar conectado correctamente.");
    } else {
      alert("Hubo un problema al intentar analizar el rendimiento. Revisa la consola para más detalles.");
    }
  }
}
    // 💡 Consejos de Trading
function getTips() {
  alert("Consejos de Trading:\n1. Diversifica tus inversiones\n2. Monitorea el mercado diariamente\n3. Usa stops de pérdida");
}

// 📊 Comparar Bots
function compareBots() {
  let comparacion = "Comparativa de Bots:\n";
  for (let i = 0; i <= 6; i++) {
    const bot = document.querySelector(`.bot-card[data-bot-id="${i}"] h3`).textContent;
    comparacion += `- ${bot}\n`;
  }
  alert(comparacion);
}

     function openTab(index) {
        let tabs = document.querySelectorAll('.tab');
        let contents = document.querySelectorAll('.tab-content');

        tabs.forEach((tab, i) => {
            tab.classList.toggle('active', i === index);
            contents[i].classList.toggle('active', i === index);
        });
    }

    async function viewHistory(botId) {
  try {
    const accounts = await web3.eth.getAccounts();
    const userAddress = accounts[0];

    // Obtener eventos del contrato relacionados con el usuario
    const pastEvents = await lythosBotContract.getPastEvents("allEvents", { 
      filter: { user: userAddress },
      fromBlock: 0, // Cambiar por el bloque de despliegue del contrato para optimizar
      toBlock: "latest"
    });

    // Filtrar eventos específicos relacionados con el botId
    const botEvents = pastEvents.filter(event => {
      return event.returnValues.botId == botId;
    });

    if (botEvents.length === 0) {
      alert(`No hay transacciones registradas para el Bot ${botId}.`);
      return;
    }

    // Formatear el historial
    const history = botEvents.map(event => {
      const eventType = event.event;
      const amount = (event.returnValues.amount / 1e6).toFixed(2);
      const timestamp = new Date(event.returnValues.timestamp * 1000).toLocaleString();
      return `${timestamp} - ${eventType}: ${amount} USDT`;
    }).join("\n");

    // Mostrar el historial
    alert(`Historial de Transacciones para el Bot ${botId}:\n\n${history}`);
  } catch (error) {
    console.error("Error al ver el historial:", error);
    alert("Hubo un problema al intentar obtener el historial de transacciones.");
  }
}





    document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".button.primary").forEach(button => {
    button.addEventListener("click", purchaseBot);
     
  });
});

  </script>
</body>
</html>
